# Security Configuration File

# Block common attacks
location ~* (\.env|\.git|\.svn|\.htaccess|\.htpasswd) {
    deny all;
    access_log off;
    log_not_found off;
}

# Block SQL injection attempts
location ~* (union.*select|select.*from|insert.*into|update.*set|delete.*from) {
    deny all;
    access_log /var/log/nginx/security.log security;
}

# Block common exploit attempts
location ~* (\.\\.|\\.\\./|/etc/passwd|/bin/bash|/bin/sh) {
    deny all;
    access_log /var/log/nginx/security.log security;
}

# Block user agents
if ($http_user_agent ~* (wget|curl|libwww|scan|bot|spider|crawler)) {
    return 444;
}

# Limit request methods
if ($request_method !~ ^(GET|POST|HEAD)$) {
    return 444;
}

# Block access to hidden files
location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
}